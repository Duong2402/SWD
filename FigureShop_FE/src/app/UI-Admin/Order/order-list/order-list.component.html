<app-side-bar></app-side-bar>
<div class="main-content">
    <h2 class="text-center text-primary mb-4">üì¶ Danh s√°ch ƒë∆°n h√†ng</h2>

    <div *ngIf="(orders?.items?.length || 0) > 0; else noOrders">
        <div class="table-responsive">
            <table class="table table-striped table-hover border rounded shadow">
                <thead class="table-primary">
                    <tr>
                        <th scope="col">STT</th>
                        <th scope="col">UserName</th>
                        <th scope="col">Ng√†y ƒë·∫∑t</th>
                        <th scope="col">T·ªïng ti·ªÅn</th>
                        <th scope="col">Tr·∫°ng th√°i</th>
                        <th scope="col" class="text-center">H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let order of orders?.items; let i = index">
                        <td>{{ i + 1 }}</td>
                        <td>{{ order.user?.userName }}</td>
                        <td>{{ order.orderDate | date:'dd/MM/yyyy HH:mm' }}</td>
                        <td>{{ order.totalAmount | number }} VND</td>
                        <td>
                            <span class="badge" [ngClass]="{
                                'bg-success': order.status === 1, 
                                'bg-danger': order.status === 2, 
                                'bg-warning': order.status === 0
                            }">
                                {{ order.status === 0 ? 'ƒêang x·ª≠ l√Ω' : (order.status === 1 ? 'Ho√†n th√†nh' : 'ƒê√£ h·ªßy') }}
                            </span>

                        </td>
                        <td class="text-center">
                            <a [routerLink]="['/order',order.id]" class="btn btn-outline-secondary btn-sm">
                                üîç Xem
                            </a>
                            <button *ngIf="order.status === 0" (click)="OrderStatus(order.id)"
                                class="btn btn-primary btn-sm ms-2" data-bs-toggle="modal"
                                data-bs-target="#updateOrderModal">
                                ‚úèÔ∏è C·∫≠p nh·∫≠t
                            </button>

                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="col-12">
            <nav>
                <ul class="pagination justify-content-center">
                    <li class="page-item" [class.disabled]="orders?.pageNumber === 1"><button class="page-link"
                            (click)="goToPage(1)">First</button></li>
                    <li class="page-item" [class.disabled]="orders?.pageNumber === 1"><button class="page-link"
                            (click)="goToPreviousPage()">Previous</button></li>
                    <li class="page-item active" [class.active]="page=== orders?.pageNumber"
                        *ngFor="let page of numberPage()">
                        <button class="page-link" (click)="goToPage(page)">{{page}}</button>
                    </li>
                    <li class="page-item" [class.disabled]="orders?.pageNumber === orders?.totalPages">
                        <button class="page-link" (click)="goToNext()">Next</button>
                    </li>
                    <li class="page-item" [class.disabled]="orders?.pageNumber === orders?.totalPages">
                        <button class="page-link" (click)="goToPage(orders?.totalPages)">Last</button>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <ng-template #noOrders>
        <p class="text-muted text-center fs-5">üòî Kh√¥ng c√≥ ƒë∆°n h√†ng n√†o.</p>
    </ng-template>
    <div class="modal fade" id="updateOrderModal" tabindex="-1" aria-labelledby="updateOrderModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="updateOrderModalLabel">üìù C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p><strong>M√£ ƒë∆°n h√†ng:</strong> {{ selectedOrderId }}</p>

                    <label for="orderStatusSelect" class="form-label">Ch·ªçn tr·∫°ng th√°i m·ªõi:</label>
                    <select class="form-select" id="orderStatusSelect" [(ngModel)]="selectedStatus">
                        <option [value]="1">‚úî Complete</option>
                        <option [value]="2">‚ùå Cancel</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                    <button type="button" class="btn btn-primary" (click)="updateOrderStatus()" data-bs-dismiss="modal">
                        L∆∞u thay ƒë·ªïi
                    </button>
                </div>
            </div>
        </div>
    </div>



</div>